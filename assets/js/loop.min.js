function SeamlessLoop(){this.is={ff:Boolean(!(null==window.mozInnerScreenX)&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)},console.debug("ff: "+this.is.ff),console.debug("ie: "+this.is.ie),console.debug("opera: "+this.is.opera),console.debug("chrome: "+this.is.chrome),console.debug("safari: "+this.is.safari),this._total=0,this._load=0,this.cb_loaded,this.cb_loaded_flag=new Boolean,this.timeout,this.playDelay=-30,this.stopDelay=30,this.is.chrome&&(this.playDelay=-25),this.is.chrome&&(this.stopDelay=25),this.is.ff&&(this.playDelay=-25),this.is.ff&&(this.stopDelay=85),this.is.opera&&(this.playDelay=5),this.is.opera&&(this.stopDelay=0),console.debug(this.playDelay+", "+this.stopDelay),this.next=1,this.audios=new Array,this.actual=new Array,this.dropOld=new Boolean,this.old,this._volume=1;var a=this;this._eventCanplaythrough=function(b){0==b&&(b=!0,a._load++,a._load==a._total&&(a.loaded=!0,1==a.cb_loaded_flag&&(a.cb_loaded(),a.cb_loaded_flag=!1)))},this._eventPlaying=function(b){setTimeout(function(){b.pause();try{b.currentTime=0}catch(a){console.debug(a.message)}},a.stopDelay),1==a.dropOld&&(setTimeout(function(){if(0==a.old.paused){a.old.pause();try{a.old.currentTime=0}catch(b){console.debug(b.message)}}},a.stopDelay),a.dropOld=!1)},this._eventEnded=function(a){a.volume=this._volume},this.doLoop=function(){var a=1==this.next?"_1":"_2",b=1==this.next?"_2":"_1",c=this;this.timeout=setTimeout(function(){c.doLoop()},this.actual._length+this.playDelay),this.is.opera&&this.actual[b].pause(),this.actual[a].play(),this.next*=-1},this.isLoaded=function(){return Boolean(this._load==this._total)}}SeamlessLoop.prototype.start=function(a){""!=a&&(this.actual=this.audios[a]),this.doLoop()},SeamlessLoop.prototype.volume=function(a){return"undefined"!=typeof a&&(this.actual._1.volume=a,this.actual._2.volume=a,this._volume=a),a},SeamlessLoop.prototype.stop=function(){clearTimeout(this.timeout),this.actual._1.currentTime=0,this.actual._1.pause(),this.actual._2.currentTime=0,this.actual._2.pause()},SeamlessLoop.prototype.callback=function(a){this.cb_loaded=a,1==this.isLoaded()?a():this.cb_loaded_flag=!0},SeamlessLoop.prototype.update=function(a,b){var c=1==this.next?"_2":"_1";this.old=this.actual[c],this.actual=this.audios[a],0==b&&(0==this.old.paused&&(this.dropOld=!0,this.is.opera&&this.old.pause()),clearTimeout(this.timeout),this.doLoop())},SeamlessLoop.prototype.addUri=function(a,b,c){this.audios[c]=new Array,this.audios[c]._length=b;var d=this;this.audios[c]._1_isLoaded=new Boolean,this.audios[c]._2_isLoaded=new Boolean,this.audios[c]._1=new Audio(a),this.audios[c]._2=new Audio(a),this._total++,this.audios[c]._1.addEventListener("canplaythrough",function(){d._eventCanplaythrough(d.audios[c]._1_isLoaded)}),this.audios[c]._2.addEventListener("canplaythrough",function(){d._eventCanplaythrough(d.audios[c]._2_isLoaded)}),this.audios[c]._1.addEventListener("playing",function(){d._eventPlaying(d.audios[c]._2)}),this.audios[c]._2.addEventListener("playing",function(){d._eventPlaying(d.audios[c]._1)}),this.audios[c]._1.addEventListener("ended",function(){d._eventEnded(d.audios[c]._1)}),this.audios[c]._2.addEventListener("ended",function(){d._eventEnded(d.audios[c]._2)}),this.audios[c]._1.load(),this.audios[c]._2.load(),this.audios[c]._1.volume=this._volume,this.audios[c]._2.volume=this._volume};
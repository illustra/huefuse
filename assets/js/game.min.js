function $(a){return document.querySelector(a)}function resetTimer(a){if(a)window.clearInterval(a);else for(var b=0;99999>b;b++)window.clearInterval(b)}var direction=!0,disabled=!0,timer,gainTime=0,endless=!1,loaded=0,loop,initialSrc=0,HueFuse={init:function(){loop=new SeamlessLoop;var a=new Audio;a.src="assets/bg/bodygold_loop.wav",a.load();var b=function(){$("#load").setAttribute("style","width: 100%"),setTimeout(function(){loop.start("intro"),$("#loading").className="hide",title=setInterval(function(){var a=function(){return Math.floor(255*Math.random())};document.querySelector("#card-home h6").style.color="rgb("+a()+","+a()+","+a()+")"},1e3)},700)},d=function(a){var b=6.25*(a+1),c=Math.round(b)+"%";$("#load").setAttribute("style","width: "+c)};a.addEventListener("canplaythrough",function(a){$("#load").setAttribute("style","width: 6.25%"),loop.addUri("assets/bg/bodygold_loop.wav",14275,"intro");for(var c=HueFuse.audio.players,e=0;e<HueFuse.audio.files.arcade;e++){var f="http://dl.aureljared.tk/huefusebg/arcade/",g=new Audio;g.src=f+e+".mp3",g.preload=!0,g.oncanplaythrough=function(a){loaded++,d(loaded),loaded==HueFuse.audio.files.total&&b()},c.arcade.push(g)}for(var h=0;h<HueFuse.audio.files.endless;h++){var f="http://dl.aureljared.tk/huefusebg/endless/",g=new Audio;g.src=f+h+".mp3",g.preload=!0,g.oncanplaythrough=function(a){loaded++,d(loaded),loaded==HueFuse.audio.files.total&&b()},c.endless.push(g)}}),$("#btn-endless").addEventListener("click",function(){endless=!0,HueFuse.begin()}),$("#btn-arcade").addEventListener("click",function(){endless=!1,HueFuse.begin()}),$("#btn-about").addEventListener("click",function(){$("#card-home").className="hide",$("#card-about").removeAttribute("class")}),$("#card-about h6").addEventListener("click",function(){$("#card-about").className="hide",$("#card-home").removeAttribute("class")}),$("#btn-endless2").addEventListener("click",function(){endless=!0,HueFuse.reset()}),$("#btn-arcade2").addEventListener("click",function(){endless=!1,HueFuse.reset()}),$("#btn-reload").addEventListener("click",function(){window.location.reload()}),document.body.addEventListener("keydown",function(a){if(!disabled){var b=a.keyCode||a.which;if(32==b)return void HueFuse.controls.submit();if(27==b)return void HueFuse.controls.toggleGame();if(37==b)index=0;else if(40==b)index=1;else{if(39!=b)return;index=2}c=HueFuse.controls.enteredColor[index],direction?c<255?c+=15:(c=255,direction=!1):c>0?c-=15:(direction=!0,c=0),attr="height:calc(80px * "+c/255+")",$("#level-"+index).setAttribute("style",attr),$("#level-"+index).setAttribute("data-level",c),HueFuse.controls.enteredColor[index]=parseInt($("#level-"+index).getAttribute("data-level")),HueFuse.controls.updateView()}})},time:20,tick:function(a){timer=window.setInterval(function(){HueFuse.time-=.1,$("#time").setAttribute("style","width:"+HueFuse.time/a*100+"%"),HueFuse.time<=0&&(HueFuse.announce("Time's up!"),resetTimer(timer),setTimeout(function(){HueFuse.gameOver()},1700))},100)},points:0,actual:[0,0,0],newLevel:function(){var b=document.body,c=function(){return Math.ceil(Math.random()*Math.random()*255)};this.actual=[c(),c(),c()],a=this.actual,b.setAttribute("style","background-color:rgb("+a[0]+","+a[1]+","+a[2]+")"),$("#time").setAttribute("style","width:100%"),HueFuse.time=20-gainTime,disabled=!0,setTimeout(function(){b.setAttribute("style","background:black"),disabled=!1,HueFuse.tick(20-gainTime)},2e3-100*gainTime)},begin:function(){document.body;loop.stop(),resetTimer(title),$("#game").setAttribute("style","background:none"),$("#card").className="hide",$("#hud").className="",HueFuse.audio.play(),HueFuse.newLevel(),HueFuse.announce("Try to match this color!")},announce:function(a){var b=$("#status");b.innerHTML=a,setTimeout(function(){b.innerHTML="&nbsp;"},2e3-100*gainTime)},controls:{enteredColor:[0,0,0],lastColor:[0,0,0],updateView:function(){var a=this.enteredColor[0],b=this.enteredColor[1],c=this.enteredColor[2];document.body.setAttribute("style","background-color:rgb("+a+","+b+","+c+")")},submit:function(){var a=this.enteredColor,b=HueFuse,c=a[0],d=a[1],e=a[2];if(a.toString()==this.lastColor.toString()){if(this.lastColor.toString()!=HueFuse.actual.toString())return void b.announce("Make a color first.")}else this.lastColor=[c,d,e];var f=Math.abs(b.actual[0]-c),g=Math.abs(b.actual[1]-d),h=Math.abs(b.actual[2]-e);50>f&&50>g&&50>h?(b.announce("Excellent!"),this.award(1)):80>f&&80>g&&80>h?(b.announce("Good!"),this.award(2)):120>f&&130>g&&130>h?(b.announce("Okay!"),this.award(3)):(b.announce("Nice try!"),this.award(4)),this.enteredColor=[0,0,0];for(var i=0;3>i;i++)$("#level-"+i).setAttribute("style","height:0");document.body.setAttribute("style","background:black"),resetTimer(timer),setTimeout(HueFuse.newLevel,500)},award:function(a){var b=function(a,b){return Math.floor(Math.random()*Math.random()*(b-a+1)+a)};4>a?1==a?HueFuse.points+=b(900,1300):2==a?HueFuse.points+=b(700,900):3==a&&(HueFuse.points+=b(400,700)):HueFuse.points+=b(100,300),endless||17>gainTime&&(gainTime+=1),$("#score").innerHTML=HueFuse.points},paused:!1,toggleGame:function(){var a=this.paused;a?this.resume():this.pause(),this.paused=!this.paused},pause:function(){resetTimer(timer),HueFuse.announce("Paused"),HueFuse.audio.pause()},resume:function(){HueFuse.announce("Resumed"),HueFuse.audio.player.play(),HueFuse.tick(20-gainTime)}},gameOver:function(){disabled=!0,$("#card").className="";for(var a=["home","high","about"],b=0;b<a.length;b++)document.getElementById("card-"+a[b]).className="hide";HueFuse.audio.pause(),HueFuse.audio.player.currentTime=0,HueFuse.audio.player.src="",$("#card-stats h1").innerHTML=HueFuse.points,document.getElementById("card-stats").removeAttribute("class")},reset:function(){$("#card").className="hide",HueFuse.points=0,HueFuse.time=0,gainTime=0,document.getElementById("score").innerHTML="0",document.getElementById("time").setAttribute("style","width:0"),HueFuse.newLevel()}};window.onload=HueFuse.init;